<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Entegrasyon - Sepettakip Kurye Entegrasyonu</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Entegrasyon";
        var mkdocs_page_input_path = "integration.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/go.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/curl.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Sepettakip Kurye Entegrasyonu
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Giriş</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Entegrasyon</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#genel-entegrasyon-yaps">Genel Entegrasyon Yapısı</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-kurye-firmas-tarafndan-hazrlanacak-servisler-inbound">1. Kurye Firması Tarafından Hazırlanacak Servisler (Inbound)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-sepettakip-tarafna-yaplacak-bildirimler-outbound-webhook">2. Sepettakip Tarafına Yapılacak Bildirimler (Outbound / Webhook)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#guvenlik-ve-yetkilendirme-headers">Güvenlik ve Yetkilendirme (Headers)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#entegrasyon-sureci">Entegrasyon Süreci</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#restoran-kimlik-dogrulama-check-credentials">Restoran Kimlik Doğrulama (Check Credentials)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#paket-olusturma-create-package">Paket Oluşturma (Create Package)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#paket-iptali-cancel-package">Paket İptali (Cancel Package)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#siparis-durum-guncellemesi-status-webhook">Sipariş Durum Güncellemesi (Status Webhook)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#webhook-response">Webhook Response</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#request-example">Request Example</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../integration_test/">Entegrasyon Testi</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../contact/">İletişim ve Destek</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Sepettakip Kurye Entegrasyonu</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Entegrasyon</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="entegrasyon">Entegrasyon</h1>
<p>Sepettakip, restoranların sipariş yönetimini ve kurye atama süreçlerini otomatikleştirmek amacıyla kurye firmaları için kapsamlı bir entegrasyon altyapısı sunar. Bu doküman, kurye firmalarının Sepettakip ekosistemine dahil olabilmesi için gerekli teknik standartları, API uç noktalarını (endpoints) ve veri akış senaryolarını detaylandırır.</p>
<h2 id="genel-entegrasyon-yaps">Genel Entegrasyon Yapısı</h2>
<p>Sepettakip ile Kurye Firması arasındaki entegrasyon RESTful API mimarisine dayanır ve veri alışverişi JSON formatında gerçekleşir. İletişim güvenliği için tüm isteklerin HTTPS protokolü üzerinden yapılması zorunludur.</p>
<p>Entegrasyonun tam fonksiyonlu çalışabilmesi için hem Kurye Firmasının geliştirmesi gereken API uç noktaları (Endpoints) hem de Sepettakip&rsquo;e geri bildirim yapılması gereken servisler bulunmaktadır. Veri akışı iki yönlüdür</p>
<h3 id="1-kurye-firmas-tarafndan-hazrlanacak-servisler-inbound">1. Kurye Firması Tarafından Hazırlanacak Servisler (Inbound)</h3>
<p>Sepettakip sunucularının, kurye operasyonlarını tetiklemek için istek (request) göndereceği servislerdir. Kurye firması bu servisleri REST API standartlarına uygun olarak dışarıya açmalıdır:</p>
<ul>
<li><strong>Restoran Kimlik Doğrulama (Check Credentials)</strong>: Restoranın girdiği Erişim Belirteci (API Key/Token) bilgisinin kurye firması sisteminde geçerli olup olmadığını kontrol eden servistir.</li>
<li><strong>Sipariş Oluşturma (Create Order)</strong>: Sepettakip&rsquo;ten gelen sipariş bilgilerini alarak sisteminde kayıt açan ve operasyonu başlatan servistir.</li>
<li><strong>Sipariş İptali (Cancel Order)</strong>: Restoranın veya sistemin iptal ettiği siparişleri kurye firması sisteminden düşürmek için kullanılan servistir.</li>
</ul>
<h3 id="2-sepettakip-tarafna-yaplacak-bildirimler-outbound-webhook">2. Sepettakip Tarafına Yapılacak Bildirimler (Outbound / Webhook)</h3>
<p>Kurye firması sisteminde gerçekleşen durum değişikliklerinin Sepettakip&rsquo;e bildirilmesidir. Kurye firması, bu olaylar gerçekleştiğinde Sepettakip API&rsquo;sine istek gönderir:</p>
<ul>
<li><strong>Sipariş Durum Güncellemesi (Status Webhook)</strong>: Paketin durumu değiştiğinde (Örn: Kurye atandı, Teslim alındı, Teslim edildi, İptal edildi) bu bilginin anlık olarak Sepettakip&rsquo;e iletilmesini sağlayan servistir.</li>
</ul>
<h2 id="guvenlik-ve-yetkilendirme-headers">Güvenlik ve Yetkilendirme (Headers)</h2>
<p>Veri bütünlüğünü ve güvenliğini sağlamak için HTTP isteklerinde aşağıdaki başlık (header) bilgileri zorunludur.</p>
<p>Yön: <strong>Sepettakip -&gt; Kurye Firması İstekleri</strong></p>
<p>Sepettakip tarafından kurye firmasına gönderilen bütün HTTP isteklerinde (Sipariş oluşturma, iptal vb.) aşağıdaki header bilgileri yer alır:</p>
<pre><code class="language-json">{   
  &quot;Api-Key&quot;: &quot;&lt;SEPETTAKIP_API_KEY&gt;&quot;
}
</code></pre>
<p>Yön: <strong>Kurye Firması -&gt; Sepettakip İstekleri (Webhook)</strong></p>
<p>Kurye firması tarafından Sepettakip&rsquo;e gönderilen bütün bildirimlerde (Durum güncelleme vb.) aşağıdaki header bilgileri yer almalıdır:</p>
<pre><code class="language-json">{   
  &quot;Courier-Company&quot;: &quot;&lt;COURIER_COMPANY_KEY&gt;&quot;,
  &quot;Api-Key&quot;: &quot;&lt;SEPETTAKIP_API_KEY&gt;&quot;
}
</code></pre>
<p><strong>Not</strong>: Test ve Production ortamlarında kullanılacak <code>COURIER_COMPANY_KEY</code> ve <code>SEPETTAKIP_API_KEY</code> bilgileri e-posta aracılığı ile temin edilecektir.</p>
<h2 id="entegrasyon-sureci">Entegrasyon Süreci</h2>
<p>Entegrasyonun sağlıklı yürütülebilmesi için Kurye Firması, API isteklerinin karşılanacağı Base URL bilgisini Sepettakip ekibine iletmelidir. Test ve Canlı (Production) ortamları için ayrıştırılmış URL yapıları kullanılması önerilir.</p>
<p><strong>Örnek Base URL Yapısı</strong>:</p>
<ul>
<li><strong>Test Ortamı</strong>: <code>https://api-test.couriercompany.com/v1</code></li>
<li><strong>Production Ortamı</strong>: <code>https://api.couriercompany.com/v1/</code></li>
</ul>
<p>Tüm API uç noktaları (endpoints) bu Base URL&rsquo;in devamına eklenir.</p>
<p><strong>Örnek</strong>: Sipariş oluşturma endpoint&rsquo;i <code>/create-package</code> ise ve test ortamındaysak tam istek adresi <code>https://api-test.couriercompany.com/v1/create-package</code> olacaktır.</p>
<h3 id="restoran-kimlik-dogrulama-check-credentials">Restoran Kimlik Doğrulama (Check Credentials)</h3>
<p>Restoranın Sepettakip paneline girdiği entegrasyon bilgilerinin (Kullanıcı adı/Şifre vb.) kurye firması tarafında doğrulanmasını sağlar. Bu adım başarılı olmadan sipariş akışı başlatılamaz.</p>
<p><strong>Endpoint</strong>: <code>/check-credentials</code><br />
<strong>Method</strong>: <code>POST</code><br />
<strong>Request Body</strong>:</p>
<pre><code class="language-json">{
    &quot;username&quot;: &quot;&quot;,
    &quot;password&quot;: &quot;&quot;
}
</code></pre>
<p><strong>Not</strong>: username olarak restoranın Sepettakip tarafındaki ID numarası kullanılması önerilir. Bu bilgi, restorandan temin edilebilir. password bilgisi ise her restoran için öze olarak üretilmelidir</p>
<p>Response olarak HTTP durum kodu 200 dönerse doğrulama başarılıdır. Aksi durumda entegrasyon etkinleşmez.</p>
<table>
<thead>
<tr>
<th>Durum Kodu</th>
<th>Durum İsmi</th>
<th>Açıklama</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>OK</td>
<td>Kimlik bilgileri doğru.</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>Kimlik bilgileri hatalı veya istek gövdesi geçersiz.</td>
</tr>
</tbody>
</table>
<p><strong>Not</strong>: Yanıt gövdesi opsiyoneldir; yalnızca http durum kodu ile karar verilebilir.</p>
<h3 id="paket-olusturma-create-package">Paket Oluşturma (Create Package)</h3>
<p>Bir sipariş &ldquo;Hazırlanıyor&rdquo; statüsüne geçtiğinde veya restoran manuel olarak tetiklediğinde bu servis çağrılır.</p>
<p><strong>Endpoint</strong>: <code>/create-package</code><br />
<strong>Method</strong>: <code>POST</code><br />
<strong>Request Body</strong>:</p>
<pre><code class="language-json">{
  &quot;auth&quot;: {
    &quot;username&quot;: &quot;789&quot;,
    &quot;password&quot;: &quot;superSecret123&quot;
  },
  &quot;restaurant&quot;: {
    &quot;id&quot;: &quot;789&quot;,
    &quot;name&quot;: &quot;The Firma&quot;
  },
  &quot;order&quot;: {
    &quot;order_id&quot;: &quot;12345&quot;,
    &quot;platform&quot;: &quot;GoFody&quot;,
    &quot;preparation_time&quot;: 5,
    &quot;note&quot;: &quot;Zili çalmayın, kapıya bırakın.&quot;,
    &quot;amount&quot;: 250.5,
    &quot;is_paid&quot;: true,
    &quot;payment_type&quot;: {
      &quot;key&quot;: &quot;credit-card&quot;,
      &quot;method&quot;: &quot;Online Kredi Kartı&quot;
    },
    &quot;address&quot;: {
      &quot;neighborhood&quot;: &quot;Abbasağa Mah.&quot;,
      &quot;address&quot;: &quot;Atatürk Cd.&quot;,
      &quot;building_no&quot;: &quot;10&quot;,
      &quot;floor&quot;: &quot;3&quot;,
      &quot;door_number&quot;: &quot;5&quot;,
      &quot;town&quot;: &quot;Beşiktaş&quot;,
      &quot;city&quot;: &quot;İstanbul&quot;,
      &quot;description&quot;: &quot;3\. kat, sağdaki daire&quot;,
      &quot;latitude&quot;: 41.0438,
      &quot;longitude&quot;: 29.0094
    },
    &quot;customer&quot;: {
      &quot;full_name&quot;: &quot;Ahmet Yılmaz&quot;,
      &quot;phone_number&quot;: &quot;+905551112233&quot;
    },
    &quot;products&quot;: [
      {
        &quot;quantity&quot;: 2,
        &quot;unit_price&quot;: 50,
        &quot;product_name&quot;: &quot;Lahmacun&quot;,
        &quot;product_note&quot;: &quot;Acısız olsun&quot;,
        &quot;total_amount&quot;: 100
      },
      {
        &quot;quantity&quot;: 1,
        &quot;unit_price&quot;: 150.5,
        &quot;product_name&quot;: &quot;Kuzu Şiş&quot;,
        &quot;product_note&quot;: &quot;&quot;,
        &quot;total_amount&quot;: 150.5
      }
    ]
  }
}
</code></pre>
<p>Not: Kurye firması, operasyonel ihtiyaçları doğrultusunda istek gövdesine (payload) ek alanlar talep edebilir; ancak temel şema korunur ve zorunlu alanlar değiştirilmez.</p>
<table>
<thead>
<tr>
<th>Ana Nesne</th>
<th>Alan</th>
<th>Tip</th>
<th>Zorunluluk</th>
<th>Açıklama</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>auth</code></td>
<td>username</td>
<td>String</td>
<td><strong>Zorunlu</strong></td>
<td>Restoran doğrulama kullanıcısı adı.</td>
</tr>
<tr>
<td><code>auth</code></td>
<td>password</td>
<td>String</td>
<td><strong>Zorunlu</strong></td>
<td>Restoran doğrulama şifresi.</td>
</tr>
<tr>
<td><code>order</code></td>
<td>order_id</td>
<td>String</td>
<td><strong>Zorunlu</strong></td>
<td>Sepettakip sistemindeki benzersiz sipariş ID&rsquo;si.</td>
</tr>
<tr>
<td><code>order</code></td>
<td>platform</td>
<td>String</td>
<td><strong>Zorunlu</strong></td>
<td>Siparişin kaynağı (Bkz: Platform Listesi).</td>
</tr>
<tr>
<td><code>order</code></td>
<td>amount</td>
<td>Float</td>
<td><strong>Zorunlu</strong></td>
<td>Siparişin toplam tutarı.</td>
</tr>
<tr>
<td><code>order</code></td>
<td>is_paid</td>
<td>Bool</td>
<td><strong>Zorunlu</strong></td>
<td>Ödeme durumu. <code>true</code>: Ödendi, <code>false</code>: Kapıda Tahsilat.</td>
</tr>
<tr>
<td><code>order</code></td>
<td>payment_type.key</td>
<td>String</td>
<td><strong>Zorunlu</strong></td>
<td>Ödeme yöntemi kodu (Bkz: Ödeme Tipleri).</td>
</tr>
<tr>
<td><code>address</code></td>
<td>latitude/longitude</td>
<td>Float</td>
<td>Opsiyonel</td>
<td>Koordinat bilgisi. <strong>Not:</strong> Telefonla siparişlerde (CallerID) bu alan <code>null</code> gelebilir.</td>
</tr>
<tr>
<td><code>address</code></td>
<td>city/town</td>
<td>String</td>
<td><strong>Zorunlu</strong></td>
<td>İl ve İlçe bilgisi.</td>
</tr>
</tbody>
</table>
<p>Adres bilgisindeki <em>latitude</em> ve <em>longitude</em> bilgisi, <em>CallerID</em> siparişlerinde ve kurye çağır ile oluşturulan siparişlerde iletilmez. Bu yüzden null değer alabilir. Ayrıca neighborhood, building_no, floor ve door_number alanları opsiyoneldir. Ödeme tipinin key bilgisi aşağıdaki değerleri alabilir.</p>
<p><strong>Desteklenen Değerler Listesi</strong>:</p>
<ul>
<li>Platformlar: <code>Gofody</code>, <code>Yemeksepeti</code>, <code>Getir</code>, <code>Trendyol</code>, <code>Sepetapp</code>, <code>Migros</code>, <code>Fuudy</code>, <code>CallerID</code>, <code>WhatsApp</code></li>
<li>Ödeme Tipleri (key): <code>paye</code>, <code>setcard</code>, <code>sodexo</code>, <code>sodexomobile</code>, <code>garantipay</code>, <code>moneypay</code>, <code>edenredonline</code>, <code>onlinecard</code>, <code>smarticket</code>, <code>sodexoonline</code>, <code>bkm</code>, <code>tokenflexonline</code>, <code>pos</code>, <code>sepetpara</code>, <code>card</code>, <code>cash</code>, <code>ticket</code>, <code>multinet</code>, <code>metropol</code>, <code>debt</code>, <code>winwin</code>, <code>tokenflex</code>, <code>cio</code>, <code>yemekmatik</code></li>
</ul>
<table>
<thead>
<tr>
<th>Durum Kodu</th>
<th>Durum İsmi</th>
<th>Açıklama</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>OK</td>
<td>Sipariş başarıyla oluşturuldu.</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>İstek gövdesi geçersiz veya zorunlu alanlar eksik.</td>
</tr>
</tbody>
</table>
<p><strong>Response Body</strong>:</p>
<pre><code class="language-json">{
    &quot;status&quot;: false,
    &quot;error_code&quot;: &quot;out_of_service_area&quot;,
    &quot;message&quot;: &quot;Adres, hizmet alanı dışında.&quot;
}
</code></pre>
<p>Uyarı: Sipariş başarıyla oluşturulduktan sonra, tüm durum güncellemeleri kurye firması tarafından Sepettakip&rsquo;e bildirilmelidir.</p>
<p>Sipariş kurye sisteminde işlenemediğinde, kurye servisinden geçerli bir hata kodu (<code>error_code</code>) dönerse, restoran arayüzünde aktarılamama nedeni bu koda karşılık gelen açıklamayla gösterilir.</p>
<p>Hata kodu iletilmez, tanınmaz veya biçim olarak geçersizse, sistem nedeni &ldquo;kurye firması kaynaklı genel hata&rdquo; olarak bildirir.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Hata Kodu (<code>error_code</code>)</th>
<th style="text-align: left;">Mesaj</th>
<th style="text-align: left;">Açıklama</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>unauthorized_access</code></td>
<td style="text-align: left;">Yetkisiz Erişim</td>
<td style="text-align: left;">API anahtarı veya şifre hatalı.</td>
</tr>
<tr>
<td style="text-align: left;"><code>out_of_service_area</code></td>
<td style="text-align: left;">Hizmet Alanı Dışı</td>
<td style="text-align: left;">Adres, kurye firmasının hizmet poligonları dışında.</td>
</tr>
<tr>
<td style="text-align: left;"><code>location_resolution_failed</code></td>
<td style="text-align: left;">Adres Hatası</td>
<td style="text-align: left;">Adres metni veya koordinatlar haritada doğrulanamadı.</td>
</tr>
<tr>
<td style="text-align: left;"><code>restaurant_closed</code></td>
<td style="text-align: left;">Restoran Kapalı</td>
<td style="text-align: left;">Kurye firması o an için hizmet vermiyor (Mesai dışı).</td>
</tr>
<tr>
<td style="text-align: left;"><code>validation_error</code></td>
<td style="text-align: left;">Validasyon Hatası</td>
<td style="text-align: left;">Eksik veya hatalı veri formatı (Örn: Telefon no eksik).</td>
</tr>
<tr>
<td style="text-align: left;"><code>company_issue</code></td>
<td style="text-align: left;">Firma Kaynaklı Problem</td>
<td style="text-align: left;">Kurye sistemi iç hatası (5xx).</td>
</tr>
<tr>
<td style="text-align: left;"><code>courier_rejected</code></td>
<td style="text-align: left;">Kurye Reddetti</td>
<td style="text-align: left;">Kurye firması siparişi kabul etmedi.</td>
</tr>
<tr>
<td style="text-align: left;"><code>other</code></td>
<td style="text-align: left;">Diğer Hata</td>
<td style="text-align: left;">Yukarıdakiler dışında kalan genel hata.</td>
</tr>
</tbody>
</table>
<h3 id="paket-iptali-cancel-package">Paket İptali (Cancel Package)</h3>
<p>Kurye firmasina iletilen bir sipariş restoran kaynaklı nedenlere iptal edildiğinde bu servis çağrılır.</p>
<p><strong>Endpoint</strong>: <code>/cancel-package</code><br />
<strong>Method</strong>: <code>POST</code><br />
<strong>Request Body</strong>:</p>
<pre><code class="language-json">{
    &quot;order_id&quot;: &quot;545&quot;
}
</code></pre>
<table>
<thead>
<tr>
<th>Durum Kodu</th>
<th>Durum İsmi</th>
<th>Açıklama</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>OK</td>
<td>Sipariş başarıyla oluşturuldu.</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>İstek gövdesi geçersiz veya zorunlu alanlar eksik.</td>
</tr>
</tbody>
</table>
<h3 id="siparis-durum-guncellemesi-status-webhook">Sipariş Durum Güncellemesi (Status Webhook)</h3>
<p>Sepettakip bir siparişi kurye firmasına aktardıktan sonra, siparişin operasyonel takibi kurye firmasındadır. Kurye firması, sahadaki tüm durum değişikliklerini (kurye atandı, teslim edildi vb.) aşağıdaki webhook servisini çağırarak Sepettakip&rsquo;e anlık olarak iletmekle yükümlüdür.</p>
<p><strong>API Base URL</strong>:</p>
<ul>
<li>Test: <code>https://test-api.sepettakip.com</code></li>
<li>Prod: <code>https://api.sepettakip.com</code>  </li>
</ul>
<p><strong>Endpoint</strong>: <code>/courier-company/package</code><br />
<strong>Method</strong>: <code>PATCH</code><br />
<strong>Headers</strong>:</p>
<pre><code class="language-json">  {
    &quot;courier-company&quot;: &quot;sepetfast&quot;,
    &quot;Api-Key&quot;: &quot;&lt;SEPETTAKIP_API_KEY&gt;&quot;
  }
</code></pre>
<p><strong>Request Body</strong>:</p>
<pre><code class="language-json">{
    &quot;order_id&quot;: &quot;12345&quot;,
    &quot;status&quot;: &quot;on_way&quot;,
    &quot;courier_eta&quot;: &quot;2023-10-25 14:30:00&quot;
}
</code></pre>
<table>
<thead>
<tr>
<th>Alan</th>
<th>Tip</th>
<th>Zorunlu</th>
<th>Varsayılan</th>
<th>Kabul Edilen Değerler</th>
<th>Açıklama</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>order_id</code></td>
<td>string</td>
<td>Evet</td>
<td>-</td>
<td>-</td>
<td>Siparişin benzersiz kimliği.</td>
</tr>
<tr>
<td><code>status</code></td>
<td>enum</td>
<td>Evet</td>
<td>-</td>
<td><code>assigned</code> · <code>picked_up</code> · <code>delivered</code> · <code>canceled</code>, <code>rejected</code></td>
<td>Sipariş durum bilgisi.</td>
</tr>
<tr>
<td><code>courier_eta</code></td>
<td>datetime</td>
<td>Hayır</td>
<td>-</td>
<td>ISO-8601 UTC (örn. <code>2025-08-18T07:30:00Z</code>)</td>
<td>Kurye tahmini varış zamanı .</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Durum</th>
<th>Açıklama</th>
<th>Not</th>
</tr>
</thead>
<tbody>
<tr>
<td>assigned</td>
<td>Kuryeye Atandı / Kurye Yola Çıktı</td>
<td>Kurye, paketi <strong>restorandan</strong> almak için yola çıktı. <code>courier_eta</code> gönderilmeli.</td>
</tr>
<tr>
<td>picked_up</td>
<td>Kurye Paketi Aldı</td>
<td>Kurye, paketi restorandan teslim aldı. Sepettakip’te sipariş “yolda” görünür.</td>
</tr>
<tr>
<td>delivered</td>
<td>Kurye Paketi Teslim Etti</td>
<td>Kurye, paketi alıcıya teslim etti. (Sipariş, Sepettakip&rsquo;te &ldquo;teslim edildi&rdquo; olarak güncellenir.)</td>
</tr>
<tr>
<td>canceled</td>
<td>Kurye Paketi İptal Etti</td>
<td>Kurye, paketi iptal etti. (Sipariş, Sepettakip&rsquo;te &ldquo;iptal edildi&rdquo; olarak güncellenir)</td>
</tr>
<tr>
<td>rejected</td>
<td>Kurye Paketi Reddetti</td>
<td>Kurye, paketi reddetti. (Restorana sadece bildirim yapılır, iptal edilmez.)</td>
</tr>
</tbody>
</table>
<h4 id="webhook-response"><strong>Webhook Response</strong></h4>
<pre><code class="language-json">{
    &quot;message&quot;: &quot;İşlem başarılı.&quot;
}
</code></pre>
<table>
<thead>
<tr>
<th>Kod</th>
<th>Açıklama</th>
<th>Notlar</th>
</tr>
</thead>
<tbody>
<tr>
<td>204</td>
<td>Güncelleme başarılı.</td>
<td>Gövde boş olabilir.</td>
</tr>
<tr>
<td>400</td>
<td>Geçersiz istek / sipariş zaten hedef statüde.</td>
<td>Alan eksik/format hatası.</td>
</tr>
<tr>
<td>401</td>
<td>API anahtarı geçersiz veya bulunamadı.</td>
<td><code>Api-Key</code> kontrol edin.</td>
</tr>
<tr>
<td>403</td>
<td>Sipariş aktarılmamış ya da farklı bir kurye firmasına ait.</td>
<td>Yetki/yönlendirme hatası.</td>
</tr>
<tr>
<td>404</td>
<td>Sipariş bulunamadı.</td>
<td><code>id</code> doğrulayın.</td>
</tr>
<tr>
<td>422</td>
<td>Mevcut statü, hedef statü için uygun değil (iş kuralı ihlali).</td>
<td>Örn. <code>courier_eta</code> zorunlu.</td>
</tr>
<tr>
<td>502</td>
<td>Sistem güncelleniyor; daha sonra deneyin.</td>
<td>Geçici durum. Yalnızca test ortamı</td>
</tr>
<tr>
<td>500</td>
<td>Beklenmeyen sunucu hatası.</td>
<td>Destek ile iletişime geçin.</td>
</tr>
</tbody>
</table>
<h4 id="request-example"><strong>Request Example</strong></h4>
<pre><code class="language-bash">curl -sS --fail \
  -X PATCH 'https://test-api.sepettakip.com/courier-company/package' \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -H 'Courier-Company: sepetfast' \
  -H 'Api-Key: aHR0cHM6Ly93d3cueW91dHViZS5jb20vc2hvcnRzL0hubEtUMkRLSGhN' \
  --data-raw '{
    &quot;order_id&quot;: 1982,
    &quot;status&quot;: &quot;on_way&quot;,
    &quot;courier_eta&quot;: &quot;2024-08-12T12:20:32.514011Z&quot;
  }'
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Giriş"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../integration_test/" class="btn btn-neutral float-right" title="Entegrasyon Testi">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../integration_test/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
